import{P as j}from"./PsButton.c9fc3d7e.js";import{P as D}from"./PsLabel.06b4363b.js";import{P as O}from"./PsLabelTitle3.78de00b9.js";import{P as S}from"./PsIcon.1e42bf4c.js";import{P as A}from"./PsDraggable.aca5d6c1.js";import{P as I}from"./PsErrorDialog.a25aef9e.js";import{_ as T}from"./plugin-vue_export-helper.21dcd24c.js";import{y as q,i as k,r as v,o as b,c as z,a as s,b as r,w as c,f as C,q as g,t as n,n as H,g as M,F as W}from"./app.d57d51e9.js";const G={name:"PsVideoUpload",props:{videoFile:{type:Object},disabled:{type:Boolean,default:!1}},components:{PsButton:j,PsLabel:D,PsLabelTitle3:O,PsIcon:S,PsDraggable:A,PsErrorDialog:I},setup(l,{emit:d}){const o=q({data:[]}),t=k(),V=k();function F(){t.value.click()}function h(){return o.data[0]}let m=k(),y=k();function P(i){const a=i.target.files;if(!(a&&a.length>1)){if(o.data=[],a&&a[0]){const p=new FileReader;p.onload=()=>{var w;const u=a[0];m.value=u.name,y.value=u.size*(1/8)*(1/1e3);const _=new Blob([(w=p.result)!=null?w:""],{type:u.type}),x=URL.createObjectURL(_),e=document.createElement("video");e.oncanplay=function(){if(e.duration>60)return V.value.openModal("Video Upload!","Video must be less than a minute.","Ok",()=>{}),!1;{const E=function(){R()&&(e.removeEventListener("timeupdate",E),e.pause())};e.addEventListener("loadeddata",function(){R()&&e.removeEventListener("timeupdate",E)});const R=function(){const f=document.createElement("canvas");f.width=e.videoWidth,f.height=e.videoHeight,f.getContext("2d").drawImage(e,0,0,f.width,f.height);const B=f.toDataURL();U(B);const N=B.length>1e5;return N&&(o.data.push(B),URL.revokeObjectURL(x)),N};e.addEventListener("timeupdate",E),a[0]}},e.preload="metadata",e.src=x,e.muted=!0,e.play()},p.readAsArrayBuffer(a[0]),d("update:videoFile",a[0])}}}function U(i){let a=i.split(","),p=a[0].match(/:(.*?);/)[1],u=atob(a[1]),_=u.length,x=new Uint8Array(_);const e=p.split("/"),w=Date.now()+"."+e[1];for(;_--;)x[_]=u.charCodeAt(_);return new File([x],w,{type:p})}function L(){if(o.data)return o.data.splice(o.data[0],1)}return{videoClick:F,video:t,onVideoSelected:P,previewVideo:o,getVideoUrl:h,ps_error_dialog:V,videoName:m,videoSize:y,close:L}}},J={class:"w-full"},K={key:0,class:"flex flex-row bg-primary-50 h-16 dark:bg-indigo-900 dark:rounded-b-lg"},Q={class:"w-20 flex flex-row justify-center items-center"},X={class:"w-20 absolute"},Y={id:"slider-full",alt:"Placeholder",width:"68px",height:"62px",class:"w-20 h-16 object-contain dark:rounded"},Z=["src"],$=["src"],ee={class:"relative w-7 h-7 bg-secondary-200 rounded-full mx-auto mt-2"},te={class:"ms-4 mt-2 flex-rows"};function oe(l,d,o,t,V,F){const h=v("ps-icon"),m=v("ps-label"),y=v("ps-button"),P=v("ps-draggable"),U=v("ps-label-title-3"),L=v("ps-error-dialog");return b(),z(W,null,[s("div",J,[r(P,{disabled:o.disabled,class:H(["mt-4 px-2.5 h-52 rounded-lg",t.previewVideo.data[0]?"border-b-0":""])},{default:c(()=>[r(h,{name:"small-cloud",theme:o.disabled?"text-secondary-300 dark:text-secondary-700":"text-secondary-500"},null,8,["theme"]),t.previewVideo.data!=""?(b(),C(m,{key:0,textColor:o.disabled?"text-secondary-300 dark:text-secondary-700 mb-2":"text-secondary-500  mb-2"},{default:c(()=>[g(n(t.previewVideo.data.length)+" "+n(l.$t("ps_image_upload__file_is_choosen")),1)]),_:1},8,["textColor"])):(b(),C(m,{key:1,textColor:o.disabled?"text-secondary-300 dark:text-secondary-700 mb-2":"text-secondary-500  mb-2"},{default:c(()=>[g(n(l.$t("ps_image_upload__no_file_is_choosen")),1)]),_:1},8,["textColor"])),s("input",{type:"file",size:"1",max:"1",accept:"video/*",ref:"video",style:{display:"none"},onChange:d[0]||(d[0]=i=>t.onVideoSelected(i))},null,544),o.disabled==!1?(b(),C(y,{key:2,type:"button",onClick:d[1]||(d[1]=i=>t.videoClick()),class:"w-26 py-1 px-2 mt-2",rounded:"rounded"},{default:c(()=>[g(n(l.$t("ps_video_upload__choose_files")),1)]),_:1})):(b(),C(y,{key:3,type:"button",disabled:!0,colors:"bg-secondary-600 text-white",class:"w-26 py-1 px-2 mt-2",rounded:"rounded"},{default:c(()=>[g(n(l.$t("ps_video_upload__choose_files")),1)]),_:1}))]),_:1},8,["disabled","class"]),t.previewVideo.data!=""?(b(),z("div",K,[s("div",Q,[s("div",X,[s("video",Y,[s("source",{src:t.getVideoUrl(),type:"video/mp4"},null,8,Z),s("source",{src:t.getVideoUrl(),type:"video/ogg"},null,8,$)])]),s("div",ee,[r(h,{name:"playCircleOutline",class:"text-white text-md"})])]),s("p",te,[r(m,{class:"font-bold"},{default:c(()=>[g(n(t.videoName),1)]),_:1}),r(U,{class:"dark:text-gray-500"},{default:c(()=>[g(n(l.$t("ps_video_upload__video_size"))+n(t.videoSize),1)]),_:1})]),r(h,{onClick:d[2]||(d[2]=i=>t.close()),textColor:l.textTheme,name:"cross",class:"text-sm ms-auto text-red-400 mt-1 focus:shadow-none hover:text-purple-500"},null,8,["textColor"])])):M("",!0)]),r(L,{ref:"ps_error_dialog"},null,512)],64)}var me=T(G,[["render",oe]]);export{me as P};
