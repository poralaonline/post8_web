import{bD as ne,y as ce,Z as de,i as m,j as me,B as c,o as l,c as k,b as n,w as u,a,Y as ue,f as h,F as J,s as te,n as Q,q as j,t as H,g as w,m as re,O as pe,r as i,E as _e}from"./app.d57d51e9.js";import fe from"./PsButton.38caef2b.js";import ge from"./PsLabel.b794d5bb.js";import be from"./PsLabelHeader4.c908098e.js";import he from"./PsIcon.9f1bf232.js";import Se from"./PsInput.a60e3eb2.js";import ye from"./PsDropdown.7e09801f.js";import ve from"./CustomCheckbox.f721f138.js";import ke from"./PsBreadcrumb2.b82160b3.js";import we from"./PsWarningDialog3.405cd9c2.js";import Ce from"./PsDropdownSelect.a17b6ef7.js";import Ie from"./PsRouteLink.0b0ba539.js";import xe from"./PsLoadingDialog.eb65b887.js";import Pe from"./PsSuccessDialog2.4e9c8310.js";import Le from"./PsErrorDialog.01320524.js";import{P as G}from"./ps_constants.115f3686.js";import{u as Ae}from"./AppInfoStore.9a878473.js";import{A as Ue}from"./AppInfoParameterHolder.e24d894d.js";import{u as He}from"./SubCategoryStore.a76ee423.js";import{P as se,b as Ee}from"./PsApiService.1464e9d5.js";import{A as ae}from"./ApiStatus.5720ba0b.js";import{m as Ne}from"./PsSepetetedStore.9a31ac47.js";import{P as Ve}from"./PsValueStore.97ab20f6.js";import{f as ie}from"./index.esm.159b9749.js";import"./PsNotificationBox.9d7f028f.js";import Be from"./PsContentContainer.07e1a234.js";import Me from"./PsFrontendLayout.296a569b.js";import Te from"./PsInputWithRightIcon.a3f5430d.js";import De from"./PsNoResult.7646aa20.js";import{P as E}from"./PsUtils.eb7a8002.js";import{_ as Fe}from"./plugin-vue_export-helper.21dcd24c.js";import"./PsModal.15d0cd4c.js";import"./vue-neat-modal.d9ed1877.js";import"./PsLine.257bf9fc.js";import"./PsLabelTitle.6c83e503.js";import"./PsObject.a17ef38f.js";import"./DefaultPhoto.cc755f93.js";import"./SubCategory.1b4176e0.js";import"./DefaultIcon.e76b39a5.js";import"./ProductStore.8e90df71.js";import"./ProductParameterHolder.e481cecf.js";import"./Product.8b62d5d3.js";import"./Category.7c65464b.js";import"./ItemLocationTownship.94979fe0.js";import"./ProductRelation.0b376978.js";import"./User.0c3ba1a8.js";import"./RatingDetail.291ad5d1.js";import"./Vendor.fb84ea36.js";import"./UserDeleteItemParameterHolder.5d816aba.js";import"./UserUnReadMessageParameterHolder.7f49d04a.js";import"./FooterView.a4d00124.js";import"./FooterLinkSection.df20daea.js";import"./PsLink.9f60ebb7.js";import"./PsLabelCaption.1fabc18a.js";import"./PsNavTabBar.51c56524.js";import"./PsIconToggle.a1ed1abf.js";import"./PsInputWithLeftIcon.098c7e47.js";import"./LocationModal.bd35d2f7.js";import"./LocationParameterHolder.654c399d.js";import"./ItemLocationTownshipStore.0ddf7240.js";import"./PsNavBar.7b51b9e1.js";import"./UserStore.cdfd4a60.js";import"./UserListParameterHolder.d110b747.js";import"./auth.esm.925cebae.js";import"./PsConfirmDialog.ca5a3fee.js";import"./NotificationStore.d8e86611.js";import"./NotiUnRegisterHolder.eefb692e.js";import"https://unpkg.com/delayed-scroll-restoration-polyfill@0.1.1/index.js";const Oe=Ne(r=>ne(`subCategoryScribeStore/${r}`,()=>{const s=ce({value:!1});async function N(S,p){s.value=!0;const C=await se.postSubCategoryScribe(new ae,S,p.toMap());return s.value=!1,C}async function e(S,p){s.value=!0;const C=await se.isUserSubscribed(new ae,S,p);return s.value=!1,C}return{subCategoryScription:N,isUserSubscribed:e,loading:s}}));class Re{constructor(){this.userId="",this.catId="",this.subCatIds=[]}SubCategoryScribeParameterHolder(){return this.userId="",this.catId="",this.subCatIds=[],this}toMap(){return{user_id:this.userId,cat_id:this.catId,sub_cat_ids:this.subCatIds}}}const ze={name:"SubCategoryListView",components:{PsNoResult:De,PsButton:fe,PsLabel:ge,PsLabelHeader4:be,PsIcon:he,PsRouteLink:Ie,PsInput:Se,PsDropdown:ye,PsLoadingDialog:xe,PsErrorDialog:Le,CustomCheckbox:ve,PsSuccessDialog2:Pe,PsBreadcrumb2:ke,PsContentContainer:Be,PsInputWithRightIcon:Te,Head:de,PsWarningDialog3:we,PsDropdownSelect:Ce},props:["query","mobileSetting","backendSetting"],layout:Me,setup(r){var X,$,ee,oe;localStorage.catId="";const s=(X=r.query)==null?void 0:X.cat_id,N=($=r.query)==null?void 0:$.cat_name,e=He(),S=Oe(),p=new Re,_=Ve().getLoginUserId(),I=new Ue;I.userId=_;const K=Ae(),A=m(!0),x=m(!1);e.limit=(oe=(ee=r.mobileSetting)==null?void 0:ee.default_loading_limit)!=null?oe:12;const y=m(),v=m();let V=m(""),B=m(""),U=m(!1),b=m([]),g=m([]);const P=m(),Z=m(),W=[{id:"0",orderBy:"name",orderType:G.FILTERING__ASC,name:"A to Z"},{id:"1",orderBy:"name",orderType:G.FILTERING__DESC,name:"Z to A"}];async function M(){}M(),e.paramHolder.catId=s,setTimeout(async()=>{await f()},1e3);function T(t){V.value=t.id,B.value=t.name,e.paramHolder.orderBy=t.orderBy,e.paramHolder.orderType=t.orderType,f()}async function D(){_!=G.NO_LOGIN_USER?(x.value==!1&&v.value.openModal(c("subcat_subscribe__how_it_works"),c("subcat_subscribe__desc"),c("payment__ok"),()=>{E.log("Ok")},()=>{E.log("Cancel")}),U.value=!0):pe.get(route("login"))}const F=ie.messaging.isSupported()?ie.messaging():null;function O(t,d){!F||fetch("https://iid.googleapis.com/iid/v1/"+t+"/rel/topics/"+d,{method:"POST",headers:new Headers({Authorization:"key="+r.backendSetting.fcm_api_key})}).then(L=>{if(L.status<200||L.status>=400)throw"Error subscribing to topic: "+L.status+" - "+L.text();console.log('Subscribed to "'+d+'"')}).catch(L=>{console.error(L)})}async function R(){for(var t=0;t<b.value.length;t++)O(localStorage.deviceToken,b.value[t]);p.userId=_,p.catId=s,p.subCatIds=b.value,b.value=[];const d=await S.subCategoryScription(_,p);d.status==Ee.SUCCESS&&(await e.resetSearchSubCategoryList(_,e.paramHolder),x.value=!0,y.value.closeModal(),d.data.message=="SUBSCRIBED"?P.value.openModal(c("subcategory__subscription_status"),c("subcategory__subscription_message"),c("core_fe__done"),()=>{E.log("ok")}):d.data.message=="UNSUBSCIRBED"?P.value.openModal(c("subcategory__subscription_status"),c("subcategory__subscription_message"),c("core_fe__done"),()=>{E.log("ok")}):P.value.openModal(c("subcategory__subscription_status"),c("subcategory__subscription_message"),c("core_fe__done"),()=>{E.log("ok")}),U.value=!1,o())}function z(){f()}async function o(){g.value=[],e.subCategoryList.data.forEach(t=>{t.isSubScribe=="1"&&g.value.push(t.id+"_FE")})}async function f(){var d;y.value.openModal(),await e.resetSearchSubCategoryList(_,e.paramHolder);const t=await S.isUserSubscribed("1",_);x.value=((d=t==null?void 0:t.data)==null?void 0:d.status)=="success",o(),y.value.closeModal(),A.value=!1}function q(){e.resetSearchSubCategoryList(_,e.paramHolder)}function Y(t){if(g.value.includes(t)){let d=g.value.indexOf(t);g.value.splice(d,1)}else g.value.push(t)}function le(t){b.value=t}return me(()=>{var t;A.value==!0&&((t=e.subCategoryList)==null?void 0:t.data)==null&&y.value.openModal()}),{updateValue:le,subCategoryStore:e,loadMore:q,subCategoryClick:Y,catId:s,catName:N,currentsorting:W,sortingFilterClicked:T,activeSortingId:V,activeSortingName:B,ps_loading_dialog:y,searchClicked:z,subCatScribe:D,scribe:U,submitScribe:R,checkedSelectedList:b,subscribedSubCatList:g,success:P,ps_error_dialog:Z,ps_warning_dialog:v,appInfoStore:K,PsConst:G,initial:A}},computed:{breadcrumb(){return[{label:c("item_list__home"),url:route("dashboard")},{label:c("sub_category_list__category"),url:route("fe_category.index")},{label:this.catName,color:"text-fePrimary-500"}]}}},qe={class:"sm:mt-32 lg:mt-36 mt-28"},je={class:"flex flex-col sm:flex-row items-center justify-between mt-24 mb-5 sm:mb-6 lg:mb-8"},Ge={class:"w-full flex content-center items-center mt-7 sm:mt-0"},Ke={class:"flex-grow lg:w-72 xl:w-76 h-10 w-full sm:w-56 md:w-60"},Ze={class:"rounded-md bg-feAchromatic-50 dark:bg-feSecondary-800 shadow-xs w-44"},We={class:"z-30"},Ye=["onClick"],Je={key:0,class:"ml-4"},Qe={class:"flex flex-col"},Xe={class:"flex flex-row mb-8"},$e={class:"w-full flex flex-col"},eo={key:0,class:"grid grid-cols-4 sm:grid-cols-4 md:grid-cols-9 lg:grid-cols-12 md:gap-6 gap-4"},oo={class:"h-44 relative flex justify-center"},to={class:"transform transition duration-500 hover:scale-110 w-full h-full object-cover",alt:""},ro={class:"w-14 h-14 absolute -bottom-7 bg-feAchromatic-50 p-3 items-center rounded-full border-2 border-white dark:bg-feSecondary-800 shadow-md"},so={alt:"Placeholder",class:"transform transition duration-500 hover:scale-110"},ao={class:"h-20"},io={class:"absolute -top-3 -right-3 w-6 h-6"};function lo(r,s,N,e,S,p){const C=i("Head"),_=i("ps-breadcrumb-2"),I=i("ps-icon"),K=i("ps-input-with-right-icon"),A=i("ps-dropdown-select"),x=i("ps-label"),y=i("ps-dropdown"),v=i("ps-button"),V=i("ps-route-link"),B=i("custom-checkbox"),U=i("ps-no-result"),b=i("ps-content-container"),g=i("ps-loading-dialog"),P=i("ps-success-dialog-2"),Z=i("ps-error-dialog"),W=i("ps-warning-dialog-3"),M=_e("lazy");return l(),k(J,null,[n(C,{title:r.$t("sub_category_list__category")},null,8,["title"]),n(b,null,{content:u(()=>{var T,D,F,O,R,z;return[a("div",qe,[a("div",je,[n(_,{items:p.breadcrumb,class:""},null,8,["items"]),a("div",Ge,[a("div",Ke,[n(K,{onKeyup:ue(e.searchClicked,["enter"]),value:e.subCategoryStore.paramHolder.keyword,"onUpdate:value":s[1]||(s[1]=o=>e.subCategoryStore.paramHolder.keyword=o),class:"",placeholder:r.$t("sub_category_list__search")},{icon:u(()=>[e.subCategoryStore.paramHolder.keyword==""?(l(),h(I,{key:0,name:"search",class:"cursor-pointer"})):(l(),h(I,{key:1,onClick:s[0]||(s[0]=o=>[e.subCategoryStore.paramHolder.keyword="",e.searchClicked()]),name:"cross",class:"cursor-pointer"}))]),_:1},8,["onKeyup","value","placeholder"])]),n(y,{horizontalAlign:"right",h:"h-auto",class:"ms-4",rounded:"rounded-lg"},{select:u(()=>[n(A,{class:"h-10 w-10 sm:w-auto sm:ps-4 ps-2.5",border:"border border-1 border-feSecondary-200 dark:border-feSecondary-400",text:"text-sm font-medium text-feAchromatic-800 dark:text-feAchromatic-100 hidden lg:inline",iconTheme:"text-feAchromatic-800 ms-2 hidden lg:inline",leftIcon:"filter",leftIconTheme:"inline lg:hidden",selectedValue:e.activeSortingName,placeholder:r.$t("sort_by")},null,8,["selectedValue","placeholder"])]),list:u(()=>[a("div",Ze,[a("div",We,[a("div",null,[(l(!0),k(J,null,te(e.currentsorting,o=>(l(),k("div",{key:o.id,class:"w-72 flex py-4 px-2 hover:bg-fePrimary-50 dark:hover:bg-feSecondary-500 cursor-pointer items-center",onClick:f=>e.sortingFilterClicked(o)},[n(x,{class:Q(["ms-2",o.id==e.activeSortingId?" font-medium":"font-light"])},{default:u(()=>[j(H(r.$t("review_entry__title"))+": "+H(o.name),1)]),_:2},1032,["class"])],8,Ye))),128))])])])]),_:1}),((O=(F=(D=(T=e.appInfoStore)==null?void 0:T.appInfo)==null?void 0:D.data)==null?void 0:F.psAppSetting)==null?void 0:O.isSubcatSubscription)==e.PsConst.ONE?(l(),k("div",Je,[e.scribe?w("",!0):(l(),h(v,{key:0,padding:"p-2",onClick:e.subCatScribe},{default:u(()=>[n(I,{class:"cursor-pointer",textColor:"text-feAchromatic-50",name:"bell-outline",h:"24",w:"24",viewBox:"0 -2 18 23"})]),_:1},8,["onClick"])),e.scribe?(l(),h(v,{key:1,padding:"p-2",onClick:e.submitScribe},{default:u(()=>[n(I,{class:"cursor-pointer",textColor:"text-feAchromatic-50",name:"bluemark",h:"24",w:"24"})]),_:1},8,["onClick"])):w("",!0)])):w("",!0)])]),a("div",Qe,[a("div",Xe,[a("div",$e,[e.subCategoryStore.subCategoryList&&e.subCategoryStore.subCategoryList.data!=null?(l(),k("div",eo,[(l(!0),k(J,null,te((R=e.subCategoryStore.subCategoryList)==null?void 0:R.data,o=>(l(),k("div",{class:"relative w-full col-span-4 sm:col-span-2 md:col-span-3 lg:col-span-4 xl:col-span-3",key:o.id},[n(V,{class:"flex-grow",to:{name:"fe_item_list",query:{cat_id:e.catId,cat_name:e.catName,sub_cat_id:o.id,sub_cat_name:o.name,status:1}}},{default:u(()=>{var f,q;return[a("div",{class:Q(["text-center cursor-pointer w-full overflow-hidden bg-feAchromatic-50 border border-feAchromatic-100 dark:border-feAchromatic-700 dark:bg-feSecondary-800 rounded-x sm:rounded-xl lg:rounded-lg hover:shadow-md",e.scribe&&e.subscribedSubCatList.filter(Y=>Y==o.id+"_FE").length==1?"border-2 border-fePrimary-500":""])},[a("div",oo,[re(a("img",to,null,512),[[M,{src:r.$page.props.thumb3xUrl+"/"+((f=o==null?void 0:o.defaultPhoto)==null?void 0:f.imgPath),loading:r.$page.props.sysImageUrl+"/loading_gif.gif",error:r.$page.props.sysImageUrl+"/default_photo.png"}]]),a("div",ro,[re(a("img",so,null,512),[[M,{src:r.$page.props.thumb2xUrl+"/"+((q=o==null?void 0:o.defaultIcon)==null?void 0:q.imgPath),loading:r.$page.props.sysImageUrl+"/loading_gif.gif",error:r.$page.props.sysImageUrl+"/default_photo.png"}]])])]),a("div",ao,[n(x,{class:"peer-checked/draft:text-sky-500 pt-9 lg:text-base sm:text-sm text-base font-medium",textColor:""},{default:u(()=>[j(H(o.name.length>20?o.name.slice(0,20)+"...":o.name),1)]),_:2},1024)])],2)]}),_:2},1032,["to"]),a("div",io,[e.scribe?(l(),h(B,{key:0,isScribe:o.isSubScribe,checked:o.id+"_FE",value:o.id+"_FE",onUpdateSelectedValue:e.updateValue,selectedValue:e.checkedSelectedList,"onUpdate:selectedValue":s[2]||(s[2]=f=>e.checkedSelectedList=f),onClick:f=>e.subCategoryClick(o.id+"_FE")},null,8,["isScribe","checked","value","onUpdateSelectedValue","selectedValue","onClick"])):w("",!0)])]))),128))])):w("",!0),e.subCategoryStore.loading.value==!1&&((z=e.subCategoryStore.subCategoryList)==null?void 0:z.data)==null&&e.initial==!1?(l(),h(U,{key:1,onOnClick:e.loadMore,class:"my-6"},null,8,["onOnClick"])):w("",!0),e.subCategoryStore.loading.value==!1&&e.initial==!1?(l(),h(v,{key:2,class:Q(["w-60 mx-auto mt-8",e.subCategoryStore.isNoMoreRecord.value?"hidden":""]),onClick:e.loadMore},{default:u(()=>[j(H(r.$t("sub_category_list__load_more")),1)]),_:1},8,["onClick","class"])):e.initial==!1?(l(),h(v,{key:3,class:"w-60 mx-auto mt-8",onClick:e.loadMore,disabled:!0},{default:u(()=>[j(H(r.$t("sub_category_list__loading")),1)]),_:1},8,["onClick"])):w("",!0)])])])])]}),_:1}),n(g,{ref:"ps_loading_dialog",class:"z-40"},null,512),n(P,{ref:"success"},null,512),n(Z,{ref:"ps_error_dialog"},null,512),n(W,{ref:"ps_warning_dialog"},null,512)],64)}var wt=Fe(ze,[["render",lo]]);export{wt as default};
